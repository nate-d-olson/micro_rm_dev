REF="CFSAN008157.HGAP.fasta"

@Filter("sort")
sort = {
	exec """ 
		java -Xmx2g -jar ~/bin/SortSam.jar 
			I= $input 
			O= $output
			SO=coordinate
	"""
}

@Transform("bam.bai")
index = {
	exec "~/bin/samtools index $input"
	forward input
}

@Transform("hc.vcf")
call_variants = {
	exec """
		java -Xmx24g -jar ~/bin/GenomeAnalysisTK.jar 
			-R $REF 
			-I $input 
			-T HaplotypeCaller  
			-o $output
	"""
}

Bpipe.run {
	sort + index + call_variants
}
